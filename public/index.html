<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <title>Meu Mundo 2D</title>
  <link rel="stylesheet" href="./css/style.css">

</head>

<body>

  <header>
    <div class="header-left">
      <h2>Conheça o desenvolvimento de jogos</h2>
    </div>

    <div class="header-right">
      <button class="jogar" onclick="jogar()">Começar</button>
      <button class="jogar" onclick="window.location.href='comunidade.html'">Comunidade</button>

    </div>

  </header>

  <main>
    <div class="fundo-game">
      <div class="banner" id="banner">
        <div class="banner-content">
          <h1>Descubra o mundo por trás dos games.</h1>
          <p style="font-size: 50%;">Aprenda, jogue, e entenda por que isso importa para mim</p>
        </div>
        <div>
          <button class="jogar" style="color:white;border-color:white; box-shadow: 5px 5px rgba(255,255,255,1)"
            onclick="jogar()">Jogar</button>
          <button class="jogar"
            style="color:white;border-color:white; background-color: rgba(0,0,0,0.1); box-shadow: none;"
            onclick="document.getElementById('sobre').scrollIntoView({behavior: 'smooth'})">Sobre</button>
        </div>
      </div>


      <div class="game-div" id="game_div">

        <canvas class="game" id="jogo_canvas"></canvas>
        <br>
        <h1 style="color:white">Faça parte da nossa cominudade</h1><button class="jogar"
          onclick="document.getElementById('auth').scrollIntoView({behavior: 'smooth'})">Login</button>
        <br> <button class="jogar"
          style="color:white;border-color:white; background-color: rgba(0,0,0,0.1); box-shadow: none;"
          onclick="pararJogo()">Parar jogo</button>

      </div>

    </div>

    <!-- Sobre o Projeto -->
    <section class="sobre" id="sobre">
      <span class="sobre-title">Porquê sobre desenvolvimento de jogos</span>
      <p style="color: rgb(136, 138, 135);">Eu gosto de jogos e gosto de criar jogos</p>

      <div class="blocos">
        <div class="blocos-item">
          <h3>Origem</h3>
          <p>Desde pequeno, os jogos marcaram momentos importantes da minha vida...</p>
          <div class="mais-texto">
            <h4>Origem – Detalhes</h4>
            <p>
              Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum vehicula metus nec elit bibendum,
              vitae pharetra velit tincidunt. Suspendisse potenti. Integer et lorem sed sem commodo condimentum. Fusce
              accumsan lectus at est efficitur...
            </p>
            <!-- aqui pode adicionar mais parágrafos, listas, imagens etc -->
          </div>
        </div>
        <div class="blocos-item">
          <h3>Conexão Pessoal</h3>
          <p>Aprender a criar jogos me fez entender como arte, código e emoção se encontram.</p>
          <div class="mais-texto">
            <h4>Conexão Pessoal – Detalhes</h4>
            <p>
              Descreva aqui como os jogos influenciaram sua vida, exemplos de momentos marcantes, ...
            </p>
          </div>
        </div>
        <div class="blocos-item">
          <h3>O que você verá aqui</h3>
          <p>Um mundo interativo que coleta suas experiências e mostra o que nos une nesse universo.</p>
          <div class="mais-texto">
            <h4>O que você verá aqui – Detalhes</h4>
            <p>
              Explique as funcionalidades previstas, fluxo de navegação, interação com usuário, ...
            </p>
          </div>
        </div>
      </div>



    </section>
    <!-- Tela de Login/Cadastro -->
    <section class="auth" id="auth">

      <div id="mensagem-alerta"
        style="display:none; position:fixed; top:30px; left:50%; transform:translateX(-50%); background:#222; color:#fff; padding:16px 32px; border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,0.2); z-index:9999; font-size:1.1rem;">
      </div>


      <h2 style="color: rgb(136, 138, 135);">Entre ou crie uma conta para salvar seu progresso e fazer parte da
        comunidade HAZE.</h2>

      <div class="auth-container">
        <h1>Login/Cadastro</h1>
        <div class="auth-header">
          <button onclick="mostrarLogin()">Login</button>
          <button onclick="mostrarCadastro()">Cadastro</button>
        </div>
        <div class="auth-content">


          <!-- Login -->
          <form class="auth-div" id="div-login" style="display: flex; flex-direction: column; gap: 10px;">
            <h2>Login</h2>
            <input id="login-email" type="email" placeholder="Email" required>
            <input id="login-senha" type="password" placeholder="Senha" required>
            <button type="button" style="align-self: center;" class="jogar" onclick="logar()">Entrar</button>
          </form>

          <!-- Cadastro -->
          <form class="auth-div" id="div-cadastro" style="display: none; flex-direction: column; gap: 10px;">
            <h2>Cadastro</h2>
            <input id="cadastro-email" type="email" placeholder="Email" required>
            <input id="cadastro-senha" type="password" placeholder="Senha" required>
            <input id="cadastro-confirmar" type="password" placeholder="Confirmar Senha" required>
            <input id="cadastro-usuario" type="text" placeholder="Usuário" required>
            <input id="cadastro-SteamId" type="text" placeholder="SteamId">
            <button type="button" style="align-self: center;" class="jogar" onclick="cadastrar()">Cadastrar</button>
          </form>


        </div>

        
    </section>


    <!--
    <div class="areas">
      <div class="area">
        <h3>Arte</h3>
        <p>O que é arte? O que é arte para você?</p>
      </div>
      <div class="area">
        <h3>Código</h3>
        <p>O que é código? O que é código para você?</p>
      </div>
      <div class="area">
        <h3>Emoção</h3>
        <p>O que é emoção? O que é emoção para você?</p>
      </div>
    </div>



    <div id="perfilSteam">
  <img id="avatarSteam" src="" alt="Avatar Steam">
  <h3 id="nomeSteam"></h3>
  <a id="linkPerfil" href="#" target="_blank">Ver perfil Steam</a>
  <button id="btnLogout" onclick="carregarPerfilSteam(76561199202684456)">Exibir Perfil</button>
</div>

-->


  </main>
  <!-- Rodapé -->
  <footer>
    <p>&copy; 2025 HAZE - Criado por Beinho</p>
  </footer>



  <script>
    
    //Função para exibir alerta login/cadastro
    function mostrarMensagem(texto, corFundo = "#222", loading = false) {
      const div = document.getElementById("mensagem-alerta");
      if (loading) {
        div.innerHTML = `${texto}<img src="./assets/circle-loading.gif" alt="Carregando..." style="height:24px;vertical-align:middle;margin-right:10px;">`;
      } else {
        div.innerText = texto;
      }
      div.style.background = corFundo;
      div.style.display = "block";
      // Esconde após 3 segundos (apenas se não for loading)
      if (!loading) {
        setTimeout(() => {
          div.style.display = "none";
        }, 3000);
      }
    }
    window.addEventListener("DOMContentLoaded", function () {
      const aviso = sessionStorage.getItem("avisoLogin");
      if (aviso) {
        alert(aviso);
        mostrarLogin(); // Função que exibe a section de login
        sessionStorage.removeItem("avisoLogin");
      }
    });

    function delay(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }
    async function logar() {
      var email = document.getElementById("login-email").value;
      var senha = document.getElementById("login-senha").value;

      if (email == "" || senha == "") {
        mostrarMensagem("Preencha todos os campos!", "#c0392b");
        return;
      }

      mostrarMensagem("Realizando Login", "#2980b9", true); // azul
      await delay(1500);

      let dados = await fetch("/usuarios/autenticar", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          emailServer: email,
          senhaServer: senha,
        })
      });

      if (!dados.ok) {
        let erro = await dados.text();
        mostrarMensagem(erro, "#c0392b");
        return;
      }

      const usuario = await dados.json();
      sessionStorage.setItem("usuario", JSON.stringify(usuario));
      mostrarMensagem("Login realizado com sucesso! Redirecionando", "#27ae60", true);
      await delay(1500);
      mostrarMensagem("Seja Bem-Vindo(a)!", "#27ae60");
      await delay(1000);
      window.location.href = "/comunidade.html";
    }


    async function cadastrar() {
      var email = document.getElementById("cadastro-email").value;
      var senha = document.getElementById("cadastro-senha").value;
      var confirmar = document.getElementById("cadastro-confirmar").value;
      var usuario = document.getElementById("cadastro-usuario").value;
      var steamId = document.getElementById("cadastro-SteamId").value;

      if (senha != confirmar) {
        mostrarMensagem("As senhas não coincidem!", "#c0392b");
        return;
      }
      if (senha.length < 6) {
        mostrarMensagem("A senha deve ter pelo menos 6 caracteres!", "#c0392b");
        return;
      }


      mostrarMensagem("Realizando Cadastro", "#2980b9", true); // azul
      await delay(1500);

      let dados = await fetch("/usuarios/cadastrar", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          emailServer: email,
          senhaServer: senha,
          nomeServer: usuario,
          steamIdServer: steamId
        })
      });

      if (!dados.ok) {
        let erro = await dados.text();
        mostrarMensagem(erro, "#c0392b");
        return;
      }

      mostrarMensagem("Cadastro realizado com sucesso! Realize o login", "#27ae60");
      await delay(1500);
      mostrarLogin();
    }



    function mostrarLogin() {
      document.getElementById("div-login").style.display = "flex";
      document.getElementById("div-cadastro").style.display = "none";
    }

    function mostrarCadastro() {
      document.getElementById("div-login").style.display = "none";
      document.getElementById("div-cadastro").style.display = "flex";
    }
  </script>
</body>


<script src="data/collisions.js"></script>
<script src="js/game.js"></script>

</html>